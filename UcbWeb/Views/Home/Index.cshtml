@model UcbWeb.ViewModels.IntroductoryInformationVM
@{
    ViewBag.Title = Resources.SYS_NAME;
}
<h2>@Resources.SYS_WELCOME_MESSAGE</h2>
<script type="text/javascript">
    /// <reference path="jquery-1.7.1.js" />
    /// <reference path="jquery-ui.js" />
    $(document).ready(function () {

        var isDirty = @(Model.IsViewDirty ? Html.Raw("true") : Html.Raw("false"));

        $(':input').change(function () {
            if (!isDirty) {
                isDirty = true;
            }
        });
		
		var $myDialogExit = $('<div id=\'exit_dialog_fw\'></div>')
        .html('@Html.Raw(@Resources.MESSAGE_EXITCONFIRMATIONPOPUP)')
        .dialog({
            autoOpen: false,
            modal: true,
            title: 'Confirmation Required',
            buttons: {
                "OK": function () {
                    $(this).dialog("close");
                    if ($('#IsExitConfirmed').val() == "True") {
                        var form = $('#mainForm')
                        var input = $("<input>").attr("type", "hidden").attr("name", "Index::ExitIntroductoryInformation").val("");
                        form.append($(input));
                        $('#mainForm')[0].submit();
                        return true;
                    }
                }
                , "Cancel": function () {
                    $(this).dialog("close");
                    return false;
                }
            }

        });

        $('#mainForm').submit(function (e) {

            if ($('#mainForm').find('input[type="submit"]:focus').attr('name') == 'Index::ExitIntroductoryInformation') {
                if (isDirty == true) {
                    e.preventDefault();
                    $('#IsExitConfirmed').val("True");
                    var returnValue = $myDialogExit.dialog('open');  //replace the div id with the id of the button/form
                    return returnValue;
                }
                else {
                    $('#IsExitConfirmed').val("True");
                    return true;
                }
            }
            else {
                return true;
            }
        });
	});
	
</script>
@using (Html.BeginForm("Index", "Home", FormMethod.Post, new { @id = "mainForm" }))
{
    
    <div class='message'>@Model.Message</div>
    @Html.ValidationSummary(false, @Resources.ERROR_SUMMARY_TITLE, new { id = "validation_errors" })

    @Html.HiddenFor(model => model.IntroductoryInformationItem.Code)
    <input type='hidden' id='IsDeleteConfirmed' name='IsDeleteConfirmed' value='@Model.IsDeleteConfirmed' />
    <input type='hidden' id='IsExitConfirmed' name='IsExitConfirmed' value='@Model.IsExitConfirmed' />
    <div class="full-width clearfix">
    <div  id="MenuItems">
        @*all the menus are going to be generated by the Helper method. It's going to be security trimmed*@

        @{var controller = ViewContext.Controller as UcbWeb.Controllers.BaseController;}
        @MenuHelper.GetNonJavaLinks(controller.sessionManager.UserName)
    </div>
        <div class="fieldset ui-widget ui-widget-content ui-corner-all">
                   <div class="legend ui-widget-header">
                <span class="ui-corner-all">@Resources.ENTITYNAME_SITEGUIDANCE</span>
        </div>
            @if (Model.AccessContext == UcbWeb.ViewModels.IntroductoryInformationAccessContext.Edit)
            {
                <div class="row">
                    <div class="editor-label left-20">
                        @Html.Label("")
                    </div>
                    <div class="editor-field right-80 giant-textbox">
                        @Html.TextAreaFor(model => model.IntroductoryInformationItem.Description, new { Value = Model.IntroductoryInformationItem.Description, @title = "Type here", @cols = 75, @rows = 25 })
                    </div>
                    <div class="full-width clearfix">
                        @Html.ValidationMessage("")
                    </div>
                </div>
            }
            else
            {
                <div class="full-width clearfix">
                    <div class="editor-field left-80">
                        @Html.Raw(@HtmlTextEditorManager.ConvertTaggedTextToHtml(Model.IntroductoryInformationItem.Description.ToString()))
                    </div>
                </div>
            }    
        </div>
		<div class="full-width clearfix">
        @if (Model.AccessContext == UcbWeb.ViewModels.IntroductoryInformationAccessContext.Edit)
        {
                <input id='SaveButton' type='submit' name='Index::SaveIntroductoryInformation' value='@Resources.LABEL_SAVEBUTTON' title='@Resources.TOOLTIP_SAVEBUTTON @Resources.ENTITYNAME_INTRODUCTORYINFORMATION'/>
                <input id='ExitButton' class='cancel' type='submit' name='Index::ExitIntroductoryInformation' value='@Resources.LABEL_EXITBUTTON' title='@Resources.TOOLTIP_EXITBUTTON'/>
        }
        else
        {
                <input id='EditButton' type='submit' name='Index::EditIntroductoryInformation' value='@Resources.LABEL_EDITBUTTON' title='@Resources.TOOLTIP_EDITBUTTON @Resources.ENTITYNAME_INTRODUCTORYINFORMATION'/>
        }
		</div>

	</div>
}

